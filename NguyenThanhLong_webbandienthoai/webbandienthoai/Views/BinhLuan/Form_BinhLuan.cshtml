@model webbandienthoai.Models.BinhLuan
@{ var tv = Session["TaiKhoans"] as webbandienthoai.Models.ThanhVien;}
<div class="col-md-4">
    <div id="review-form">
        @using (Html.BeginForm("Form_BinhLuan", "BinhLuan", FormMethod.Post, new { @class = "review-form", @id = "formreview" }))
        {
            @Html.AntiForgeryToken()

            @Html.Hidden("MaTV", tv.MaTV)
            @Html.Hidden("MaSP", new { @ViewBag.MaSP })
            @Html.TextAreaFor(x => x.NoiDungBL, new { @class = "input", @placeholder = "Viết bình luận" })
            <div class="input-rating">
                <span>Đánh giá: </span>
                <div class="stars">
                    <input id="star5" name="DanhGia" value="5" type="radio"><label for="star5"></label>
                    <input id="star4" name="DanhGia" value="4" type="radio"><label for="star4"></label>
                    <input id="star3" name="DanhGia" value="3" type="radio"><label for="star3"></label>
                    <input id="star2" name="DanhGia" value="2" type="radio"><label for="star2"></label>
                    <input id="star1" name="DanhGia" value="1" type="radio"><label for="star1"></label>
                </div>
            </div>
            <button class="primary-btn" id="review_submit">Gửi</button>
        }
    </div>
</div>
<script>
    $(function () {
        $('#formreview').submit(function (e) {
            e.preventDefault(); // Ngăn chặn gửi form
            submitForm(); // Gửi form bằng AJAX
        });

        function submitForm() {
            $.ajax({
                url: '@Url.Action("Form_BinhLuan", "BinhLuan")',
                type: 'POST',
                data: $('#formreview').serialize(),
                success: function (res) {
                    if (res.Success) {
                        window.location.reload();
                    }
                },
                error: function () {
                    alert("Có lỗi khi bình luận!");
                }
            });
        }
    });
</script>
