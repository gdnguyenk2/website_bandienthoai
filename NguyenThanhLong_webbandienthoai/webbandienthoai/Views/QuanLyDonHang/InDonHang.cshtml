@using webbandienthoai.Models
@model DonDatHang
@{
    ViewBag.Title = "In đơn hàng";
    Layout = "~/Views/Shared/_Layout_Admin.cshtml";
}

<h2>Thông tin đơn hàng<font color="red">@Model.KhachHang.TenKH</font></h2>
<br />
<br />

    <div class="table ChiTietDonHang">
        @{ IEnumerable<ChiTietDonDatHang> lstChiTietDH = ViewBag.ctdh as IEnumerable<ChiTietDonDatHang>;}
        <table class="table" id="table">
            <tr>
                <td colspan="4">
                    <table style="width:100%">
                        <tr>
                            <td>Mã đơn hàng:<b style="color:red">@Model.MaDDH @Html.Hidden("MaDDH", Model.MaDDH)</b></td>
                            <td>Mã khách hàng:<b style="color:red">@Model.MaKH</b></td>
                            <td>Tên khách hàng:<b style="color:red">@Model.KhachHang.TenKH</b></td>
                            <td>Ngày Đặt:@Model.NgayDatHang</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan="4">
                    <table style="width:100%">
                        <tr>
                            <td>Đã Thanh toán:@ViewBag.DaThanhToan</td>
                            <td>Tình Trạng giao:@ViewBag.TinhTrang</td>
                            <td>Ngày Giao Hàng:@Model.NgayGiao</td>
                        </tr>
                    </table>
                </td>
            </tr>
            @*Thông tin chi tiết đơn hàng*@
            <tr>
                <td><b>Sản phẩm</b></td>
                <td><b>Hình ảnh</b></td>
                <td><b>Số lượng đặt</b></td>
                <td><b>Đơn giá đặt</b></td>
            </tr>
            @foreach (var item in lstChiTietDH)
            {
                <tr>
                    <td>@item.SanPham.TenSP</td>
                    <td><img src="@Url.Content("~/Content/Images/Products/" + item.SanPham.HinhAnh)" style="width:120px;height:100px" /></td>
                    <td>@item.SoLuong</td>
                    <td>@item.DonGia</td>

                </tr>
            }
            <tr>
                <td align="right" colspan="4">Tổng số lượng: @Model.ChiTietDonDatHangs.Sum(n => n.SoLuong)</td>
            </tr>
            <tr>
                <td align="right" colspan="4">Tổng tiền: @Model.ChiTietDonDatHangs.Sum(n => n.SoLuong * n.SanPham.DonGia).Value.ToString("#,##")</td>
            </tr>
        </table>
        <br /><br />
        @Html.ActionLink("Quay Lại", "DaGiaoDaThanhToan", "QuanLyDonHang", new { @class = "btn btn-success" })
        <input type="button" value="In đơn hàng" id="btnInDonHang" class="btn btn-primary" />
    </div>
    <script>
        $("#btnInDonHang").click(function () {
            var content = "<table>"+$("#table").html()+"</table>";
            InDonHang(content);
        })
        function InDonHang(content) {
            var printWindow = window.open('', '', 'height=450,width=800');
            printWindow.document.write('<html><head><title>DIV Content</title>');
            printWindow.document.write('</head></body>');
            printWindow.document.write(content);
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.print();
        }
    </script>
